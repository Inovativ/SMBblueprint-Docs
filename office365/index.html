<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Inovativ">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Office 365 - SMB Blueprint</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">SMB Blueprint</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Introduction</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../install/">installation</a>
</li>

                        
                            
<li >
    <a href="../office365-install/">Office 365</a>
</li>

                        
                            
<li >
    <a href="../azure-install/">Azure</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Office 365</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Azure</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../azure-arm-intro/">Resource Manager introduction</a>
</li>

        
            
<li >
    <a href="../azure-smb-intro/">SMBblueprint overview</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../about/">About</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../azure-install/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../azure-arm-intro/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/Inovativ/SMBblueprint-Docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#office-365-user-group-provisioning">Office 365 User &amp; Group Provisioning</a></li>
        
            <li><a href="#introduction">Introduction</a></li>
        
            <li><a href="#starting-the-deployment">Starting the deployment</a></li>
        
            <li><a href="#preflight-check">Preflight check</a></li>
        
            <li><a href="#provisioning">Provisioning</a></li>
        
            <li><a href="#review">Review</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="office-365-user-group-provisioning">Office 365 User &amp; Group Provisioning<a class="headerlink" href="#office-365-user-group-provisioning" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Office 365 customers can be managed by their hosting partners using the <a href="https://partner.microsoft.com/en-us/cloud-solution-provider">CSP model</a>.</p>
<p>This allows for hosting partner personnel to administrate the subscription without needing any direct connection with the customer itself.</p>
<p>SMBBlueprint simplifies the initial provisioning of O365 users and (private) Office groups for a CSP tenant by providing a Powershell-based deployment workflow.</p>
<h2 id="starting-the-deployment">Starting the deployment<a class="headerlink" href="#starting-the-deployment" title="Permanent link">&para;</a></h2>
<p>The cmdlet <strong>New-SMBOfficeDeployment</strong> can be used to initiate the deployment.</p>
<p>The deployment needs to be started with a certain set of parameters that specify both the connection info towards the target tenant (PowerShell-parameters), as well as a CSV file that contains the user and group payload to be provisioned.</p>
<pre><code>Note: For the full explanation of the parameters, refer to the PowerShell documentation of the Office deployment cmdlet.
</code></pre>

<h3 id="csv">CSV<a class="headerlink" href="#csv" title="Permanent link">&para;</a></h3>
<p>The deployment needs a valid CSV file with the following information:</p>
<ul>
<li>First (the first-name of the user)</li>
<li>Last (the last-name of the user)</li>
<li>Title (the user's title or function)</li>
<li>DisplayName (currently not in use)</li>
<li>Department (the user's department)</li>
<li>Office (the user's office location)</li>
<li>Mobile (the user's mobile phone number)</li>
<li>Country (the user's country, expressed as an <a href="https://www.iso.org/obp/ui/#search">ISO-code</a>)</li>
<li>Groups (the group to which the user should belong)<ul>
<li>If the group is mentioned for the first time, the associated user will be set as owner. Subsequent users that have the same group specified will be a regular member.</li>
<li>The created groups will be private Office Groups</li>
</ul>
</li>
<li>License (the license to assign to the user, expressed as the SKU code, which can be found using get-msolaccountsku -TenantId \&lt;ID of your CSP tenant>)<ul>
<li>You can get the tenant-id's under your CSP account by connecting to your root Azure AD with 'Connect-MSOLService' and then querying the tenants with 'Get-MSOLPartnerContract -All|select DefaultDomainName,TenantId'</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Example CSV:</strong><br />
First,Last,Title,DisplayName,Department,Office,Mobile,Country,Groups,License<br />
Jan,Van Meirvenne,Consultant,Jan.VanMeirvenne,ICT,Inovativ,32478707741,BE,TestGroup1,O365_BUSINESS_PREMIUM<br />
Jin,Van Meirvenne,Consultant,Jin.VanMeirvenne,ICT,Inovativ,32478707741,BE,TestGroup10,O365_BUSINESS_PREMIUM<br />
Jon,Van Meirvenne,Consultant,Jon.VanMeirvenne,ICT,Inovativ,32478707741,BE,TestGroup10,O365_BUSINESS_PREMIUM </p>
</blockquote>
<h3 id="mail-domain">Mail Domain<a class="headerlink" href="#mail-domain" title="Permanent link">&para;</a></h3>
<p>Before this solution is used, a validated custom domain needs to be present in the tenant's configuration.
By default, the tenant domain that is marked as default will be used as primary mail suffix. A specific domain can be chosen by providing the '-MailDomain <MailDomainName>' parameter (in the GUI, an option to control this is available as well).</p>
<pre><code>Note: While using the standard &lt;TenantName&gt;@onmicrosoft.com suffix is not blocked, the user won't be able to send/receive mails.
</code></pre>

<h3 id="default-password">Default Password<a class="headerlink" href="#default-password" title="Permanent link">&para;</a></h3>
<p>A parameter 'DefaultPassword' can be passed. This sets the initial logon for ALL users in the CSV to a specific password. If the parameter is omitted, a random password is generated.</p>
<h2 id="preflight-check">Preflight check<a class="headerlink" href="#preflight-check" title="Permanent link">&para;</a></h2>
<p>Before starting the provisioning, a few conditions are checked:
<em> The CSP credential must be valid
</em> The entered Tenant ID or Domain must be present in the CSP partner's directory
    * Note: Do not confuse the tenant-domain with the tenant's own domains. The tenant domain is the value that is shown in the CSP portal, and not the tenant's admin portal!
* The licenses specified in the CSV-file must not be more that the ones available in the subscription</p>
<h3 id="csp-admin-account">CSP Admin account<a class="headerlink" href="#csp-admin-account" title="Permanent link">&para;</a></h3>
<p>Not all resources can be reliably deployed by the CSP model currently. This consists of:
<em> Onedrive For Business
</em> Office 365 groups</p>
<p>To work around this limitation, the deployment will use the CSP credential to create an admin user within the tenant itself, and proceed to use this last one to configure the restricted resources.
The password for this user is randomly generated and renewed everytime the SMbBlueprint solution is ran. This means that the CSP admin user can not be used for login without manually resetting the password.
The password is not stored in any outputs.</p>
<h2 id="provisioning">Provisioning<a class="headerlink" href="#provisioning" title="Permanent link">&para;</a></h2>
<p>When all checks are passed OK, the CSV information is used to commence the actual provisioning.</p>
<p>This happens in the following order:
1) Create the users in the tenant's Azure AD, set the password and license information
<em> If a user already exists, no action is performed
2) Connect to the Exchange interface of O365 and create the groups. Assign ownership based on the CSV-information.
</em> If a group already exists, no action is performed
3) Populate the standard memberships for the created groups
4) Bulk provision all created users' OneDrive using the Sharepoint Online Management shell</p>
<h2 id="review">Review<a class="headerlink" href="#review" title="Permanent link">&para;</a></h2>
<p>When the provisioning completes, an object is returned containing the following information:
<em> Type (the deployment-type. This will be 'Office' for deployments started with this function)
</em> Duration (the duration of the deployment)
<em> Status (Provides status-information for the deployment)
    * Configuration (contains several outputs of the deployment)
        * ProvisionedUsers (a list of all provisioned users including login-information)
        * ProvisionedGroups (a list of all provisioned office groups)
</em> Completed (equals 'TRUE' if the deployment is done)
<em> Error (if an exception occured during the deployment, it will be stored here)
</em> Log (the full location of the logfile for the deployment)</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
